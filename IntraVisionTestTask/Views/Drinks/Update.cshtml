@model Drinks

<h1 class="display-4">Обновление напитка</h1>

<div class="d-none">
    <input class="form-control" name="idDrink" value="@Model.Id">
</div>

<div class="form-group mb-2">
    <label>Название</label>
    <input class="form-control" name="name" value="@Model.Name" placeholder="Введите название напитка">
</div>

<div class="form-group mb-2">
    <label>Цена</label>
    <input class="form-control mb-3" name="price" value="@Model.Price" placeholder="Введите цену">
</div>

<div class="form-group mb-2">
    <label>Количество</label>
    <input class="form-control mb-3" name="amount" value="@Model.Amount" placeholder="Введите количество">
</div>

<div class="mb-3">
    <input type="file" class="form-control" name="files" required>
    <div class="invalid-feedback">Загрузите изображение напитка</div>
</div>

<p name="changeMethod"><a class="btn btn-success w-100">Обновить</a></p>

@section Scripts{
    <script>

        function RedirectPage(data) {
            window.location = data;
        }

        $('p[name="changeMethod"]').click(function () {
            let Id = $('input[name="idDrink"]').val().toString();
            let name = $('input[name="name"]').val().toString();
            let price = $('input[name="price"]').val().toString();
            let amount = $('input[name="amount"]').val().toString();
            let img = $('input[name="files"]').prop("files");

            formData = new FormData();
            formData.append("Id", Id);
            formData.append("Name", name);
            formData.append("Price", price);
            formData.append("Amount", amount);
            formData.append("Img", img[0]);
            
            $.ajax({
                type: "PUT",
                url: '@Url.Action("UpdateAdmin", "Drinks")',
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: RedirectPage,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Authorization", "Bearer " + sessionStorage.getItem("token"));
                }
            })
        })
    </script>
}
